name: /pub/medical/laboratory/4tvc-microlab/v6
desc: The latest version Microlab by Four Thieves Vinegar Collective.
cover:
  assembly: microlab

docs:
  intro: |
    This is a [PartCAD](https://partcad.org/) package for MicroLab.
    It is intended to maintain the information about all the parts
    for the following purposes: manufacturing, procurement and assembly
    (both manual and automated assembly instructions).

    *DISCLAIMER: PartCAD is still under heavy development, and so is
    the PartCAD package for Microlab. Please, consider contributing to
    both PartCAD and this package, but do not yet use this package
    for manufacturing or ordering Microlab parts.*

{% from 'urls.j2' import url_prefix %}
{% set url = url_prefix + '/v6' %}

sketches:
  m26:
    type: basic
    circle: 13 # 13 mm radius equals to 26 mm diameter

parts:
  # Control Unit
  control-box:
    desc: Regular size control box
    type: step
    fileFrom: url
    fileUrl: {{ url }}/control-box/control-box-v.1.1.step
    implements:
      "/pub/std/metric/m:m3-thru":
        outer-left: [[3, 3, 75], [1, 0, 0], 180]
        outer-right: [[205, 3, 75], [1, 0, 0], 180]
        inner-left: [[3, 3, 69.5], [1, 0, 0], 0]
        inner right: [[205, 3, 69.5], [1, 0, 0], 0]
    ports:
      rpi: [[8, 36, 51], [-0.71, -0.71, 0], 180]
      uno: [[131.5, 39.5, 8], [0.71, 0.71, 0], 180]
  control-box-lid:
    desc: Control box lid for regular size control box
    type: step
    fileFrom: url
    # TODO(clairbee): Update the fileUrl to the correct file once it is fixed
    fileUrl: {{ url }}/control-box/control-box-lid-v.1.0.step
    # fileUrl: {{ url }}/control-box/control-box-lid-flat-v.1.0.step
    implements:
      "/pub/std/metric/m:m3-thru":
        outer-left: [[-101, -47, 4], [1, 0, 0], 180]
        outer-right: [[101, -47, 4], [1, 0, 0], 180]
        inner-left: [[-101, -47, 0], [1, 0, 0], 0]
        inner-right: [[101, -47, 0], [1, 0, 0], 0]
  control-box-flat:
    desc: Low profile control box
    type: step
    fileFrom: url
    fileUrl: {{ url }}/control-box/control-box-flat-v.1.0.step
    implements:
      "/pub/std/metric/m:m3-thru":
        outer-left: [[3, 3, 44], [1, 0, 0], 180]
        outer-right: [[185, 3, 44], [1, 0, 0], 180]
        inner-left: [[3, 3, 33], [1, 0, 0], 0]
        inner-right: [[185, 3, 33], [1, 0, 0], 0]
    ports:
      rpi: [[8, 22.5, 20], [-0.71, -0.71, 0], 180]
      uno: [[179.5, 92, 8], [0, 1, 0], 180]
  control-box-lid-flat:
    desc: Control box lid for low profile control box
    type: step
    fileFrom: url
    fileUrl: {{ url }}/control-box/control-box-lid-flat-v.1.0.step
    implements:
      "/pub/std/metric/m:m3-thru":
        outer-left: [[-91, -89, 4], [1, 0, 0], 180]
        outer-right: [[91, -89, 4], [1, 0, 0], 180]
        inner-left: [[-91, -89, 0], [1, 0, 0], 0]
        inner-right: [[91, -89, 0], [1, 0, 0], 0]
  relay-case-no-top:
    desc: Relay board case without a top cover
    type: step
    fileFrom: url
    fileUrl: {{ url }}/control-box/sub-components/relay-board-case-50x73x17mm-no-top.step
  relay-case:
    desc: Relay board case with a top cover
    type: step
    fileFrom: url
    fileUrl: {{ url }}/control-box/sub-components/relay-case-50x73x17mm.step
  stepdown-case:
    desc: A case fir 12V-to-5V stepdown converter
    type: step
    fileFrom: url
    fileUrl: {{ url }}/control-box/sub-components/stepdown-case-63x27x14mm.step
  
  # Reactor Unit
  pumps-box:
    desc: Pumps box
    type: step
    fileFrom: url
    fileUrl: {{ url }}/pumps-box/pumps-box-v.1.0-rotated.step
    implements:
      "/pub/std/metric/m:m3-thru":
        upper-left: [[5, 64, 183], [1, 0, 0], 90]
        # TODO: commented out as not used so far, but may be needed later, or deleted
        # upper-right: [[183, 64, 183], [1, 0, 0], 90]
        # lower-left: [[5, 64, 5], [1, 0, 0], 90]
        # lower-right: [[183, 64, 5], [1, 0, 0], 90]
        pump-x-upper-left: [[12.5, 0, 179], [1, 0, 0], -90]
        pump-y-upper-left: [[75, 0, 179], [1, 0, 0], -90]
        pump-z-upper-left: [[137.5, 0, 179], [1, 0, 0], -90]
      # TODO: simplification here, concrete mounting to be elaborated
      "/pub/std/metric/m:m24-thru":
        heat-pump-opening: [[4, 19, 64], [0, 1, 0], 90]
        cool-pump-opening: [[184, 19, 64], [0, 1, 0], -90]        
  pumps-box-lid:
    desc: Lid for pumps box
    type: step
    fileFrom: url
    fileUrl: {{ url }}/pumps-box/pumps-box-lid-v0.3-rotated.step
    implements:
      "/pub/std/metric/m:m3-thru":
        upper-left-back: [[5, 4, 183], [1, 0, 0], 90]
        upper-right-back: [[183, 4, 183], [1, 0, 0], 90]
        lower-left-back: [[5, 4, 5], [1, 0, 0], 90]
        lower-right-back: [[183, 4, 5], [1, 0, 0], 90]
        upper-left-front: [[5, 0, 183], [1, 0, 0], -90]
        # TODO: commented out as not used so far, but may be needed later, or deleted
        # upper-right-front: [[183, 0, 183], [1, 0, 0], -90]
        # lower-left-front: [[5, 0, 5], [1, 0, 0], -90]
        # lower-right-front: [[183, 0, 5], [1, 0, 0], -90]
  peristaltic-pump:
    desc: Peristaltic pump (model Intllab DP-520-48S)
    type: step
    fileFrom: url
    fileUrl: {{ url }}/pumps-box/peristaltic-pump.step
    implements:        
      "/pub/std/metric/m:m3-thru":
        upper-left-back: [[-26.75, 20.5, 18.75], [1, 0, 0], 90]
        upper-right-back: [[27.25, 20.5, 18.75], [1, 0, 0], 90]
        lower-left-back: [[-26.75, 20.5, -18.75], [1, 0, 0], 90]
        lower-right-back: [[27.25, 20.5, -18.75], [1, 0, 0], 90]
        upper-left-front: [[-26.75, 15.5, 18.75], [1, 0, 0], -90]
        upper-right-front: [[27.25, 15.5, 18.75], [1, 0, 0], -90]
        lower-left-front: [[-26.75, 15.5, -18.75], [1, 0, 0], -90]
        lower-right-front: [[27.25, 15.5, -18.75], [1, 0, 0], -90]
  circulation-pump:
    desc: Circulation pump (https://www.amazon.com/dp/B09XH1GYYQ)
    type: step
    fileFrom: url
    fileUrl: {{ url }}/pumps-box/circulation-pump.step
    implements:
      # TODO: describe proper mounting
      "/pub/std/metric/m:m24-shaft":
        mount: [[0, 0, 52], [1, 0, 0], 0]        
  stand-part-h:
    desc: Reactor stand "H" part
    type: step
    fileFrom: url
    fileUrl: {{ url }}/reactor-stand/reactor-stand-H.v1.0.step

  # Temperature Exchange Units
  # straw:
    # desc: Tube for cooling unit
    # type: cadquery
  cold-unit-lid:
    desc: Lid for cooling unit
    type: step
    fileFrom: url
    fileUrl: {{ url }}/temperature-units/cold-unit-lid-v.1.0.step
    implements:
      "/pub/std/metric/m:m10-thru":
        left-outer: [[-24, 0, 0], [1, 0, 0], 0]
        right-outer: [[24, 0, 0], [1, 0, 0], 0]
  hot-unit-lid:
    desc: Lid for heating unit
    type: step
    fileFrom: url
    fileUrl: {{ url }}/temperature-units/hot-unit-lid-v.1.0.step

assemblies:
  microlab:
    type: assy
    path: microlab.assy
  control-unit:
    type: assy
    path: control-unit.assy
    parameters:
      profile:
        type: string
        desc: Profile of the control box
        enum: [regular, flat]
        default: flat
      screw_type:
        type: string
        desc: Type of the screws attaching lid to the control box
        enum: [raisedcountersunkovalhead-iso7047, raisedcheesehead-iso7045]
        default: raisedcountersunkovalhead-iso7047
    render:
      svg:
        viewportOrigin: [75, 0, 150]
  reactor-unit:
    type: assy
    path: reactor-unit.assy
    parameters:
      screw_type:
        type: string
        desc: Type of the screws attaching lid to the control box
        enum: [raisedcountersunkovalhead-iso7047, raisedcheesehead-iso7045]
        default: raisedcountersunkovalhead-iso7047
  heating-unit:
    type: assy
    path: heating-unit.assy
  cooling-unit:
    type: assy
    path: cooling-unit.assy

render:
  svg:
    lineWeight: 1.5
  readme:
